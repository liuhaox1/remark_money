# Remark Money 全功能用例清单（可执行版）

> 使用方式：按模块逐条执行；每条用例都要求记录【实际结果/截图/日志】并标记 Pass/Fail。
> 
> 说明：用例覆盖所有代码入口（见 `docs/qa_full_test_plan.md`），并按优先级（P0/P1/P2）分层。

---

## 0) 通用检查点（每条用例都要关注）
- UI：文案/格式（金额、小数位、日期）、空态、加载态、失败态、可点击区域、返回栈
- 数据：列表↔统计↔报表↔导出↔同步后一致
- 性能：列表滚动/筛选/切换页是否明显卡顿、是否掉帧/闪烁
- 稳定性：连续操作、反复进出、前后台切换不崩溃

---

## 1) 数据准备（必须先做）

### QA-DATA-001（P0）一键造数：生成基准数据集
- 入口：`/ui-lab`（UI Lab）→ `QA 工具（仅 Debug）` → `清空后重建`
- 期望：
  - 自动创建并切换到 `qa-book`
  - 生成多账户/多标签/多笔记录（含跨月跨年/闰日/边界时间/不计入统计）
  - 回到 Home/Bill/Analysis/Assets/Report 能立即看到数据

### QA-DATA-002（P1）追加造数：重复执行不报错
- 步骤：再次点击 `追加生成`
- 期望：不会崩溃；数据增加；统计/余额刷新正确

---

## 2) 启动与初始化

### QA-BOOT-001（P0）冷启动初始化成功
- 前置：清空 App 数据（或首次安装）
- 步骤：启动 App
- 期望：无崩溃；能进入主界面；数据库初始化/迁移无阻塞（无长时间白屏）

### QA-BOOT-002（P0）前后台切换与恢复
- 步骤：进入任意页面 → 切后台 30s → 回前台
- 期望：页面状态可恢复；列表不为空/不乱序；无重复弹窗

### QA-BOOT-003（P1）系统杀进程恢复
- 步骤：进入账单页 → 系统杀进程 → 重新打开
- 期望：可恢复到可用状态；不会出现数据层异常提示；必要时重新加载

---

## 3) 账本（Book）

### QA-BOOK-001（P0）新建账本
- 步骤：Profile → 账本管理（入口在 `profile_page.dart`）→ 新建
- 期望：新账本出现；切换后数据隔离（记录/标签/预算/计划等不串）

### QA-BOOK-002（P0）切换账本后联动刷新
- 步骤：在账本A造数 → 切换到账本B → 返回账单/统计
- 期望：账单/统计/标签列表都与当前账本一致（不显示A的数据）

### QA-BOOK-003（P1）删除账本（含数据）
- 步骤：创建两个账本 → 往其中一个写入记录 → 删除该账本
- 期望：符合产品策略（禁止/二次确认/连带清理）；不会残留“幽灵数据”

---

## 4) 账户/资产（Assets/Account）

### QA-ACC-001（P0）默认钱包兜底
- 前置：无任何账户（清空账户数据或新装）
- 步骤：直接记一笔（AddRecord）
- 期望：自动出现“默认钱包/现金”账户；记账不中断

### QA-ACC-002（P0）新增不同类型账户
- 步骤：资产页 → 新增账户 → 依次创建现金/储蓄卡/信用卡/虚拟/投资/贷款/自定义资产
- 期望：每种类型都能创建；字段校验正确；列表分组正确

### QA-ACC-003（P0）余额随记账变化
- 步骤：选择某账户新增支出100 → 再新增收入200 → 删除支出100
- 期望：账户余额变化正确；资产页汇总（总资产/总负债/净资产）同步正确

### QA-ACC-004（P1）账户删除（有流水）
- 步骤：对某账户写入多笔记录 → 尝试删除该账户
- 期望：符合产品策略（禁止/提示迁移）；不会导致记录列表崩溃或展示异常

### QA-ACC-005（P1）账户流水页面筛选/跳转
- 步骤：进入账户详情 → 查看账户流水 → 点击某条流水进入编辑页
- 期望：跳转参数正确；编辑保存后返回刷新正确

---

## 5) 分类（Category）

### QA-CAT-001（P0）默认分类存在且可用
- 步骤：进入记一笔 → 打开分类选择器
- 期望：默认分类树可展开；收入/支出分类隔离；“未分类”兜底可用

### QA-CAT-002（P0）新增/编辑/删除分类
- 步骤：分类管理 → 新增分类 → 修改名称/图标 → 删除分类
- 期望：分类列表更新；记一笔选择器更新；删除后旧记录显示策略正确

### QA-CAT-003（P1）隐藏分类不出现在记一笔
- 步骤：检查隐藏 key（如 `fin_loan` 等）在记一笔分类选择器中是否可见
- 期望：这些“财务操作类”默认不出现在普通消费分类选择器

---

## 6) 标签（Tag）

### QA-TAG-001（P0）新增标签去重
- 步骤：创建标签“旅行”→ 再创建同名“旅行”
- 期望：返回已有标签；不会生成重复标签

### QA-TAG-002（P0）记录绑定多标签
- 步骤：对同一条记录绑定2个标签 → 保存 → 返回账单页
- 期望：展示/筛选/报表（如有关联）一致；重新进入仍存在

### QA-TAG-003（P1）删除标签
- 步骤：删除一个已绑定到记录的标签
- 期望：记录上的标签联动消失或保持策略明确；不会崩溃

---

## 7) 记账（AddRecord）

### QA-REC-001（P0）支出/收入新增
- 步骤：新增支出 12.34（含备注）→ 新增收入 56.78
- 期望：Home、账单、统计、资产余额都正确；金额符号/颜色正确

### QA-REC-002（P0）金额校验边界
- 步骤：输入 0、0.001、负数、超大值、3位小数
- 期望：按 `Validators` 规则拦截并提示；不会写入脏数据

### QA-REC-003（P0）日期边界
- 步骤：选择月初 00:00、月末 23:59、跨年、闰日（2024-02-29）
- 期望：账单周/月/年范围包含/排除正确；报表范围一致

### QA-REC-004（P0）编辑/删除回滚
- 步骤：新增支出100 → 编辑为200 → 删除
- 期望：统计与余额完全回滚；不会残留重复记录/幽灵记录

### QA-REC-005（P1）模板（RecordTemplate）
- 步骤：创建模板 → 套用模板 → 修改部分字段保存
- 期望：模板字段覆盖规则正确；套用后可继续编辑；保存后结果正确

### QA-REC-006（P1）语音记账入口跳转
- 步骤：从 AddRecord 进入 VoiceRecordPage
- 期望：权限申请与失败提示正确；识别文本解析正确；能落库成记录

---

## 8) 账单页（Bill）

### QA-BILL-001（P0）周/月/年/日切换范围正确
- 步骤：在同一批数据上切换模式；对比范围起止日期展示与实际列表
- 期望：范围与列表一致；切换不丢筛选状态（或符合产品设计）

### QA-BILL-002（P0）搜索（关键字/历史/清空）
- 步骤：搜索“QA-1”→ 选择历史项 → 清空关键字
- 期望：命中字段正确；历史更新去重；清空后回到未搜索状态

### QA-BILL-003（P0）筛选组合（分类多选+账户多选+金额+日期）
- 步骤：同时开启多条件筛选
- 期望：结果集正确；筛选摘要正确；“清空筛选”恢复到未筛选

### QA-BILL-004（P1）无数据空态
- 步骤：选择一个没有记录的范围
- 期望：空态文案正确；不崩溃；导出按钮状态合理

### QA-BILL-005（P1）大数据性能（压力集）
- 前置：导入/造数到 1万+ 记录
- 步骤：快速滚动、频繁切换筛选与周期
- 期望：不卡死/不崩溃；渲染稳定；内存不持续上涨

---

## 9) 统计分析 & 报表详情（Analysis/ReportDetail）

### QA-ANA-001（P0）口径一致：列表汇总=统计=报表
- 步骤：选定一个月范围 → 记录账单列表汇总 → 对比 Analysis 汇总/ReportDetail 分类汇总
- 期望：完全一致（允许四舍五入误差需明确规则）

### QA-ANA-002（P1）成就边界
- 步骤：0记录/只有收入/只有支出/跨月连续记账
- 期望：成就展示符合规则；不会出现除0/空列表崩溃

### QA-REP-001（P1）报表分享导出图片
- 步骤：ReportDetail → 分享/导出图片
- 期望：文件生成成功；权限/失败提示明确；分享取消不影响状态

---

## 10) 预算（Budget）

### QA-BUD-001（P0）设置预算并联动超支
- 步骤：对某分类设预算 → 记账超过预算
- 期望：预算进度/超支提示正确；与账单统计口径一致

### QA-BUD-002（P1）includeInStats 不计入预算
- 步骤：新增一笔 includeInStats=false 的支出
- 期望：预算与统计均不包含该笔

---

## 11) 定时记账（Recurring）

### QA-RECUR-001（P0）创建 weekly/monthly 定时记账
- 步骤：创建每周/每月计划 → 等待触发或手动模拟时间（前后台）
- 期望：到期生成记录；不会重复生成；生成后在账单/统计可见

### QA-RECUR-002（P1）禁用/删除计划
- 步骤：禁用计划 → 到期不生成；删除计划 → 列表消失
- 期望：行为符合预期；无残留任务

---

## 12) 存钱计划（SavingsPlan）

### QA-SAVE-001（P0）创建/编辑/删除计划
- 步骤：创建计划 → 修改目标/备注 → 删除
- 期望：列表与详情一致；删除后无残留

---

## 13) 导入导出（Export/Import）

### QA-EXP-001（P0）导出 Excel/PDF/CSV
- 步骤：Profile → 导入导出 → 导出三种格式
- 期望：文件可打开；字段完整；金额精度正确；时间范围正确；无数据提示正确

### QA-IMP-001（P1）导入容错（脏数据/重复）
- 步骤：导入缺字段/非法金额/重复记录的文件
- 期望：给出明确错误/跳过策略；不会写入半条记录；导入后统计一致

---

## 14) 同步/冲突（Sync v2）

### QA-SYNC-001（P0）离线产生本地变更 → 恢复网络后自动同步
- 步骤：断网 → 新增/编辑/删除若干对象（记录/标签/分类/账户/预算）→ 恢复网络
- 期望：outbox 能重试；最终云端一致；无重复/丢失

### QA-SYNC-002（P0）多设备冲突
- 步骤：设备A修改分类名；设备B同时删除该分类/修改同名标签
- 期望：冲突可见并可解决；解决后各页面一致；不会出现“删了又回来”

### QA-SYNC-003（P1）强制修复同步入口
- 入口：Profile → “一键修复同步”
- 期望：执行过程中有 loading；完成有明确结果；失败有可重试提示

---

## 15) Profile / 登录 / VIP / 礼品码 / 反馈 / 条款

### QA-AUTH-001（P0）登录/登出与本地状态清理
- 步骤：登录 → 退出登录（如有）→ 再登录
- 期望：token 与同步相关本地状态按策略清理；不会导致全量重复拉取或数据错乱

### QA-VIP-001（P1）VIP页可达与错误提示
- 步骤：进入 VIP 购买页 → 模拟网络失败/服务端失败
- 期望：错误提示可读；不影响主功能使用

### QA-GIFT-001（P1）礼品码兑换
- 步骤：输入有效/无效/已兑换码
- 期望：结果提示正确；失败可重试；不会崩溃

### QA-FB-001（P1）意见反馈
- 步骤：提交反馈（含超长文本/空文本/网络失败）
- 期望：校验与提示正确；失败可重试；成功后状态清晰

### QA-LEGAL-001（P2）条款与隐私可访问
- 步骤：进入条款隐私页面
- 期望：内容可读；返回正常

